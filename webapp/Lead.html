<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>

<link rel="stylesheet" type="text/css" href="Styles/header.css" />
<title>Infographics Generator</title>
	<script type="text/javascript" src="Scripts/HandleDate.js"></script>
	<script type="text/javascript" src="Scripts/KPILocalStorage.js"></script>
	<script type="text/javascript" src="Scripts/elements.js"></script>
	<script type="text/javascript" src="Scripts/draw-service.js"></script>
	<script type="text/javascript" src="Scripts/jquery-1.7.1.min.js"></script>
	<script type="text/javascript" src="Scripts/jquery.wipetouch.js"></script>
	<script type="text/javascript">
	function DrawUniqueCustomers(c,x,y)
	{
		var canvas = document.getElementById(c);
		var context = canvas.getContext("2d");

		var lineWidth = 7;
		context.save();
		context.arc(x+170, y-50, 20, 0, 2 * Math.PI, false);
		context.fillStyle = "#000000";
		context.fill();

		//draw man
		context.moveTo(x + 130, y +30);
		context.lineTo(x + 170 ,y +30);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		//draw man
		context.moveTo(x + 170, y -30);
		context.lineTo(x + 170 ,y +30);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		//draw man
		context.moveTo(x + 170, y -20);
		context.lineTo(x + 100 ,y -10);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		// draw 
		context.beginPath();
		context.moveTo(x , y);
		context.lineTo(x +100 , y);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		// draw 
		context.moveTo(x -20, y+40);
		context.lineTo(x +120 , y+40);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		// draw leg
		context.moveTo(x +30, y);
		context.lineTo(x +10 , y+80);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		// draw legs
		context.moveTo(x +65, y);
		context.lineTo(x +85 , y+80);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		// draw 

		context.moveTo(x + 10, y);
		context.lineTo(x + 10 , y-70);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		// draw umbrella
		context.moveTo(x -60, y-70);
		context.lineTo(x +80 , y-70);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();


		// draw umbrella
		//context.beginPath();
		context.moveTo(x-60, y-70);
		context.quadraticCurveTo(x+10, y-120, x+80, y-70);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.fillStyle = "#000000";
		context.fill();
		context.stroke();

		//draw computer
		context.moveTo(x +50, y-10);
		context.lineTo(x +90 , y-10);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		//draw computer
		context.moveTo(x + 50, y-10);
		context.lineTo(x + 40 ,y-40);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		//draw chair
		context.moveTo(x + 140, y+80);
		context.lineTo(x + 140 ,y +40);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		//draw chair
		context.moveTo(x + 180, y+80);
		context.lineTo(x + 180 ,y -10);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		//draw chair
		context.moveTo(x + 140, y +40);
		context.lineTo(x + 180 ,y +40);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();

		//draw man
		context.moveTo(x + 130, y +30);
		context.lineTo(x + 130 ,y +80);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.restore();
				
	}
	
	function DrawResponse(c, x, y, kpiMail, kpiPhone)
	{
		var canvas = document.getElementById(c);
		var context = canvas.getContext("2d");
		img = new Image();
		img.src = 'images/response.png';
		context.fillStyle = "#8ED6FF";
		var kpiTotal = kpiMail + kpiPhone;
		var MailP = kpiMail/kpiTotal;
		var PhoneP= kpiPhone/kpiTotal;
		//document.write(MailP);
		//draw mail

		context.beginPath();
		context.rect(x+1, y, 373, -120);
		context.fill();
		context.lineWidth = 1;
		context.strokeStyle = "white";
		context.stroke();


		//draw rectangle in the back of the mail image
		if(MailP <= 0.5)
		{
			fillW= 700 * MailP; 
			fillH = 50;
			MailP = 0;
		}
		else if(MailP > 0.5)
		{
			MailP = MailP-0.5;
			fillW= 350; 
			fillH = 50;
		}
		context.fillRect(x+10, y+10, fillW, fillH);
		if(MailP > 0)
		{
			fillW= 700 * MailP;
			fillH = 50;

			context.fillRect(x+10,y+100, fillW, fillH);
		}



		context.fillStyle="#FFA54F";
		context.beginPath();
		context.rect(x+376, y, 370, -120);
		context.fill();
		context.lineWidth = 1;
		context.strokeStyle = "white";
		context.stroke();

		//draw rectangle in the back of the phone image
		if(PhoneP <= 0.5)
		{
			fillW= 760 * PhoneP; 
			//fillW = 350
			fillH = 80;
			PhoneP = 0;
		}
		else if(PhoneP > 0.5)
		{
			PhoneP = PhoneP-0.5;
			fillW= 720/2; 
			fillH = 80;
		}
		context.fillRect(x+740, y+80, x-20-fillW, fillH);			
		if(PhoneP > 0)
		{
			fillW= 720 * PhoneP;
			fillH = 80;

			context.fillRect(x+740,y+8, x-20-fillW, fillH);
			//document.write(x+740);	
		}					


		img.onload = function()
		{
			context.drawImage(img, x, y, img.width/4.29, img.height/4.29);
		}

		
	}
	
	function DrawSales(c, x, y, kpiLost, kpiNew, kpiOld)
	{
		var canvas = document.getElementById(c);
		var context = canvas.getContext("2d");
		var lineWidth = 7;
		img1 = new Image();
		img1.src = 'images/lead_usedcar.png';
		img2 = new Image();
		img2.src = 'images/lead_newcar.png';

		context.beginPath();
		context.arc(x-50, y, 20, 0, 2 * Math.PI, false);
		context.fillStyle = "#000000";
		context.fill();


		
		//draw man body
		context.moveTo(x-50, y);
		context.quadraticCurveTo(x - 40, y+30, x-50, y + 65);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		
		
		//draw man
		context.moveTo(x -50, y + 65);
		context.lineTo(x - 80, y + 100);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();


		//draw man
		context.moveTo(x -50, y + 65);
		context.lineTo(x -20, y + 80);
		context.lineTo(x -35, y + 100);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.moveTo(x -50, y + 40);
		context.quadraticCurveTo(x - 60, y+20, x - 100, y+15);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.moveTo(x-50, y + 45);
		context.quadraticCurveTo(x - 60, y+30, x - 100, y +30);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		//draw door
		context.save();
		context.beginPath();
		context.fillStyle="#black";
		context.beginPath();
		context.rect(x, y-60, 80, 170);
		context.fill();
		
		context.beginPath();
		context.arc(x+15, y+20, 5, 0, 2 * Math.PI, false);
		context.fillStyle = "#ffffff";
		context.fill();
		context.restore();
		
		
		//draw whiteboard
		context.beginPath();
		context.save()
		context.moveTo(x-410, y - 50);
		context.lineTo(x-130, y - 50);
		context.lineTo(x-130, y - 130);
		context.lineTo(x-410, y - 130);
		context.lineTo(x-410, y - 50);
		context.moveTo(x-410, y - 43);
		context.lineTo(x-130, y - 43);
		context.lineWidth = lineWidth;
		context.lineCap = "square";
		context.strokeStyle = "#000000";
		context.stroke();
		context.fillStyle = "#ffffff";
		context.fill();
		context.restore();
		
		
		//draw marker
		context.beginPath();
		context.moveTo(x-240, y - 45);
		context.lineTo(x-200, y - 45);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#ffffff";
		context.stroke();
		
		
		//draw tables
		context.beginPath();
		context.fillStyle="#black";
		context.beginPath();
		context.rect(x-300, y + 110, 100, -60);
		context.fill();

		context.beginPath();
		context.moveTo(x-330, y + 50);
		context.lineTo(x-170, y + 50);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		
		context.fillStyle="#black";
		context.beginPath();
		context.rect(x-570, y + 110, 100, -60);
		context.fill();

		context.beginPath();
		context.moveTo(x-600, y + 50);
		context.lineTo(x-440, y + 50);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		//draw chairs
		
		context.beginPath();
		context.moveTo(x-120, y);
		context.lineTo(x-120, y + 110);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.moveTo(x-120, y + 70);
		context.lineTo(x-160, y + 70);
		context.lineTo(x-160, y + 110);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.beginPath();
		context.moveTo(x-390, y);
		context.lineTo(x-390, y + 110);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.moveTo(x-390, y + 70);
		context.lineTo(x-430, y + 70);
		context.lineTo(x-430, y + 110);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.beginPath();
		context.moveTo(x-380, y);
		context.lineTo(x-380, y + 110);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.moveTo(x-380, y + 70);
		context.lineTo(x-340, y + 70);
		context.lineTo(x-340, y + 110);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.beginPath();
		context.moveTo(x-640, y);
		context.lineTo(x-640, y + 110);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.moveTo(x-640, y + 70);
		context.lineTo(x-600, y + 70);
		context.lineTo(x-600, y + 110);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		
		//draw man (big)
		context.beginPath();
		context.arc(x - 150, y, 20, 0, 2 * Math.PI, false);
		context.fillStyle = "#000000";
		context.fill();
		
		context.beginPath();
		context.moveTo(x-150, y);
		context.lineTo(x-150, y + 60);
		context.lineTo(x-180, y + 60);
		context.lineTo(x-180, y + 100);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.beginPath();
		context.moveTo(x-150, y+40);
		context.quadraticCurveTo(x - 210, y +50, x-150, y+10);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		
		context.beginPath();
		context.arc(x - 420, y, 20, 0, 2 * Math.PI, false);
		context.fillStyle = "#000000";
		context.fill();
		
		context.beginPath();
		context.moveTo(x-420, y);
		context.lineTo(x-420, y + 60);
		context.lineTo(x-450, y + 60);
		context.lineTo(x-450, y + 100);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.beginPath();
		context.moveTo(x-420, y+40);
		context.quadraticCurveTo(x - 490, y +50, x-420, y+10);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		
		//draw man (small)
		context.beginPath();
		context.arc(x - 350, y, 20, 0, 2 * Math.PI, false);
		context.fillStyle = "#000000";
		context.fill();
		context.beginPath();
		
		context.moveTo(x-350, y);
		context.lineTo(x-350, y + 60);
		context.lineTo(x-320, y + 60);
		context.lineTo(x-320, y + 100);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.beginPath();
		context.moveTo(x-350, y+40);
		context.quadraticCurveTo(x - 330, y +50, x-320, y+10);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
				
		context.beginPath();
		context.arc(x - 610, y, 20, 0, 2 * Math.PI, false);
		context.fillStyle = "#000000";
		context.fill();
		context.beginPath();
		
		context.moveTo(x-610, y);
		context.lineTo(x-610, y + 60);
		context.lineTo(x-580, y + 60);
		context.lineTo(x-580, y + 100);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		context.beginPath();
		context.moveTo(x-610, y+40);
		context.quadraticCurveTo(x - 590, y +50, x-570, y+10);
		context.lineWidth = lineWidth;
		context.lineCap = "round";
		context.strokeStyle = "#000000";
		context.stroke();
		
		img1.onload = function()
		{
			context.drawImage(img1, x-295, y + 8, img1.width/4, img1.height/4);
		}
		
		img2.onload = function()
		{
			context.drawImage(img2, x-565, y +10, img2.width/1.75, img2.height/1.75);
		}
		
	}
	
	//DrawAvgRespTime: Infographic Element 
	//Author: Kevin Shreve	
	function DrawAvgRespTime (c, x, y, w, h, d)
	{
		var canvas = document.getElementById(c);
		var context = canvas.getContext("2d");
	
		context.font = "28pt Calibri";
		context.fillStyle = "#000";
		context.fillText("Average Response Time", x+105, y-50);
		context.fillText(" minutes",x+175,y-10);
		context.font = "bold  28pt Calibri";
		context.fillText(d[1],x+105,y-10);
		//DrawClockDial(c,x,y,w,h);
		DrawClockFace(c,x,y,w,h,d);
	}
	
	//DrawClockDial: Draws the small nub on the side of the watch
	//Author: Kevin Shreve
	function DrawClockDial(c,x,y,w,h) {
		var canvas = document.getElementById(c);
		var ctx = canvas.getContext("2d");
		
		ctx.fillStyle = "C9C9C9";
		ctx.fillRect(x+85,y-(15/2),10,15);
		ctx.fillStyle = "#000";
		ctx.fillRect(x+87,y-5,5,10);
	}
	//DrawClockFace: Draws the circles and the tick marks
	//Author: Kevin Shreve
	function DrawClockFace(c,x,y,w,h,d) {
		var canvas = document.getElementById(c);
		var ctx = canvas.getContext("2d");
		
		//context.font = "40pt Calibri";
		//context.fillStyle = "#000";
		//context.fillText("In Kevin we Trust", canvas.width/3, 50);
		
		DrawCircle(c,x,y,90,"#C9C9C9");
		DrawCircle(c,x,y,70,"#FFF");
		DrawCircle(c,x,y,65,"#C9C9C9");
		DrawCircle(c,x,y,10,"#FFF");
	
		ctx.fillStyle = "#000";
		for(var k=1;k<13;k++) {
			ctx.save();
			ctx.translate(x,y);
			ctx.rotate(2*k*Math.PI/12);
			ctx.translate(-x,-y);
			ctx.fillRect(x-5,y-75,10,20);
			ctx.restore();
		}	
		DrawHand(c,x,y,w,h,d);
	}
	
	//DrawHand : Draws the minute and hour hands of the clock
	//Author: Kevin Shreve	
	function DrawHand(c,x,y,w,h,d) {
		var canvas = document.getElementById(c);
		var ctx = canvas.getContext("2d");
		
		var hand=new Image;
		hand.src = 'images/watcharm.png';
		hand.onload = function () {
			ctx.save();
			ctx.translate(x,y)
			ctx.rotate( d[1] / 2 *(Math.PI/180));
			ctx.translate(-x,-y)
			//hour hand
			ctx.drawImage(hand,x-(hand.width/2),y-(hand.height/2)-30,50,60);
			ctx.restore();
			
			ctx.save();
			ctx.translate(x,y);
			ctx.rotate( d[1]*6*(Math.PI/180));
			ctx.translate(-x,-y);
			//minute hand
			ctx.drawImage(hand,x-(hand.width/2),y-(hand.height/2)-45);	
			ctx.restore();
		}	
	}
	
	//DrawCircle: Cirlce with color option
	//Author: Kevin Shreve
	function DrawCircle(c,x,y,r,color) {
		var canvas = document.getElementById(c);
		var context = canvas.getContext("2d");
		var centerX = x;
		var centerY = y;
		var radius = r; 

		context.beginPath();
		context.arc(centerX, centerY, r, 0, 2 * Math.PI, false);
		context.fillStyle = color;
		context.fill();
	}

	window.onload = function(){
		var canvas = document.getElementById("myCanvas");
		var context = canvas.getContext("2d");
		context.canvas.width = window.innerWidth;
		//context.canvas.height = window.innerHeight;

		// data
		var month = "May";
		var year = "2012";
		
		
		initDate();

		// fake kpi
		var kpiUnique = 1831;
		var kpiMail = 1602;
		var kpiPhone = 687;
		var kpiLost = 12;
		var kpiNew = 36;
		var kpiOld = 12;
		var kpiAve = new Array();
		kpiAve[0] = 50.2;
		kpiAve[1] = 41.2;
		DrawUniqueCustomers("myCanvas", 200, 190);
		DrawResponse("myCanvas", 20, 417, kpiMail, kpiPhone);
		DrawAvgRespTime ("myCanvas", 130, 680, 5, 5, kpiAve);
		DrawSales("myCanvas", 680, 850, kpiLost, kpiNew, kpiOld);

		//section

		context.beginPath();
		context.moveTo(25 , 300);
		context.lineTo(25 , 980);
		context.lineWidth = 2;
		context.lineCap = "square";
		context.strokeStyle = "#000000";
		context.stroke();
				
		context.moveTo(25 , 300);
		context.lineTo(760 , 300);
		context.lineWidth = 2;
		context.lineCap = "square";
		context.strokeStyle = "#000000";
		context.stroke();
				
		context.moveTo(760 , 300);
		context.lineTo(760 , 980);
		context.lineWidth = 2;
		context.lineCap = "square";
		context.strokeStyle = "#000000";
		context.stroke();

				
		//Text

		//Title
		//Unique Customers
		context.font = "40pt Calibri";
		context.fillStyle = "#000000";
		context.font = "24pt Calibri";
		context.fillText("Lead Management ", 10, 50);
		context.font = "60pt Calibri";
		context.fillText(month + ", " + year,300,80);


		//Unique Customers
		context.font = "40pt Calibri";
		context.fillStyle = "#000000";
		context.font = "30pt Calibri";
		context.fillText("Unique Customers", 430, 180);
		context.font = "60pt Calibri";
		context.fillText(kpiUnique,510,250);

		//Response Method
		var x = 0;
		var y = -250;
		context.font = "40pt Calibri";
		context.fillStyle = "#000000";
		context.font = "30pt Calibri";
		context.fillText("Response by", x + 30,y + 580);
		context.fillText("Mail",x + 30, y + 620);
		context.font = "60pt Calibri";
		context.fillText(kpiMail,x + 110, y+ 650);

		context.font = "40pt Calibri";
		context.fillStyle = "#000000";
		context.font = "30pt Calibri";
		context.fillText("Response by", x + 550, y + 580);
		context.fillText("Phone", x + 650, y + 620);
		context.font = "60pt Calibri";
		context.fillText(kpiPhone,x + 480, y + 650);

		//sales
		
		var x = 100;
		var y = 950;
		
		//
		context.fillStyle = "#ffffff";
		context.font = "45pt Calibri";
		context.fillText(kpiNew, x + 30,y );
		context.fillText(kpiOld, x + 300,y );
		context.fillText(kpiLost, x + 590,y );
		
		context.fillStyle = "#000000";
		context.font = "28pt Calibri";
		context.fillText("Sales from Lead", x + 190,y -180);
		context.fillText("New", x + 30,y -100);
		context.fillText("Used", x + 295,y -100);
		context.fillStyle = "#ffffff";
		context.fillText("Lost", x + 590,y -100);
		
		//var date = new Date;
		//Drawing Average response time
		//DrawAvgRespTime("myCanvas", canvas.width/5, 150, canvas.width, canvas.height, [date,15]);//GetKPI(date,"Avg_Response_Time")]);
	};
 
        </script>
    </head>
	<body>
	<div id="main">
		<div id="header">
			<img src="images/header.jpg">
			<a href="index.html"><img id="hButton" src="images/homeButton2.png"></a>
			<p id="category">Lead</p>
			<p id="month"></p>
			<p id="month2"></p>
		</div>
		<div id="ele">
			<img src="images/lead_ele.png"/>
		</div>
		
		<canvas id="myCanvas" width="1000" height="1500">
		<!-- Insert fallback content here -->
		Sorry, your browser doesn't support canvas technology
		</canvas>

		<div id="stone">
			<img src="images/lead_stone.jpg"/ width = "745px" height="400px">
		</div>
		<div id="sep1">
			<img src="images/lead_sep.png"/>
		</div>	
	</div>
	</body>
</html>