<!DOCTYPE HTML>
<html>
    <head>
        <script>
            function DrawSection (c, x, y, w, h, d)
            {

                var sectionColor = d[1]; // this is the color of the section bubble blurb thingy
                var pointerHeight = 44; // this is the height of the little top thingy
                var pointerDistance = d[0]; // this is the distance from x where the pointer will be placed
                var cornerCurveSize = 33; // this is the radius of the corner curve

                var canvas = document.getElementById(c);
                var context = canvas.getContext("2d");

                // draw section
                context.beginPath();
                context.moveTo(x, y + pointerHeight + cornerCurveSize);
                
                // left side
                context.lineTo(x, h);

                // bottom
                context.lineTo(x + w, y + h);

                // right side
                context.lineTo(x + w, y + pointerHeight + cornerCurveSize);

                // check if pointer is too far right
                if (pointerDistance + pointerHeight > w - cornerCurveSize)
                {

                    // top right corner
                    context.quadraticCurveTo(x + w, y + pointerHeight, x + w - ((x + w - pointerDistance) / 2), y + pointerHeight);

                    // pointer right side
                    context.quadraticCurveTo(x + pointerDistance, y + pointerHeight, x + pointerDistance, y);
                }
                else
                {
                    // top right corner
                    context.quadraticCurveTo(x + w, y + pointerHeight, x + w - cornerCurveSize, y + pointerHeight);

                    // top line right side
                    context.lineTo(x + pointerDistance + pointerHeight, y + pointerHeight);

                    // pointer right side
                    context.quadraticCurveTo(x + pointerDistance, y + pointerHeight, x + pointerDistance, y);
                }

                // check if pointer is too far left
                if (pointerDistance - pointerHeight < cornerCurveSize)
                {
                    // pointer left side
                    context.quadraticCurveTo(x + pointerDistance, y + pointerHeight, x + (pointerDistance / 2), y + pointerHeight);

                    // top left corner
                    context.quadraticCurveTo(x, y + pointerHeight, x, y + pointerHeight + cornerCurveSize);

                }
                else
                {
                    // pointer left side
                    context.quadraticCurveTo(x + pointerDistance, y + pointerHeight, x + pointerDistance - pointerHeight, y + pointerHeight);

                    // top line left side
                    context.lineTo(x + cornerCurveSize, y + pointerHeight);

                    // top left corner
                    context.quadraticCurveTo(x, y + pointerHeight, x, y + pointerHeight + cornerCurveSize);
                }


                // end draw stuff
                context.closePath();
                context.fillStyle = sectionColor;
                context.fill();

            }

            function DrawCloud (c, x, y, w, h)
            {
                // BUG: Need to add raindrops
                var canvas = document.getElementById(c);
                var context = canvas.getContext("2d");

                // draw cloud
                context.beginPath();
                context.moveTo(170*(w/430)+x, 80*(h/180)+y);
                context.bezierCurveTo(130*(w/430)+x, 100*(h/180)+y, 130*(w/430)+x, 150*(h/180)+y, 230*(w/430)+x, 150*(h/180)+y);
                context.bezierCurveTo(250*(w/430)+x, 180*(h/180)+y, 320*(w/430)+x, 180*(h/180)+y, 340*(w/430)+x, 150*(h/180)+y);
                context.bezierCurveTo(420*(w/430)+x, 150*(h/180)+y, 420*(w/430)+x, 120*(h/180)+y, 390*(w/430)+x, 100*(h/180)+y);
                context.bezierCurveTo(430*(w/430)+x, 40*(h/180)+y, 370*(w/430)+x, 30*(h/180)+y, 340*(w/430)+x, 50*(h/180)+y);
                context.bezierCurveTo(320*(w/430)+x, 5*(h/180)+y, 250*(w/430)+x, 20*(h/180)+y, 250*(w/430)+x, 50*(h/180)+y);
                context.bezierCurveTo(200*(w/430)+x, 5*(h/180)+y, 150*(w/430)+x, 20*(h/180)+y, 170*(w/430)+x, 80*(h/180)+y);
                context.closePath();

                // make gradient
                var grd = context.createRadialGradient(238*(w/430)+x, 50*(h/180)+y, 10*(w/430), 238*(w/430)+x, 50*(h/180)+y, 200*(w/430));
                grd.addColorStop(0, "#dddddd"); // light grey
                grd.addColorStop(1, "#555555"); // dark grey
                context.fillStyle = grd;
                context.fill();

            }


            function DrawSun (c, x, y, r)
            {
                // BUG: Need to add sunbeams
                var canvas = document.getElementById(c);
                var context = canvas.getContext("2d");

                var centerX = x / 2;
                var centerY = y / 2;
                var radius = r; 

                context.beginPath();
                context.arc(centerX, centerY, r, 0, 2 * Math.PI, false);
                context.fillStyle = "#FFEF00";
                context.fill();
            }
            function DrawHouse (c, x, y, h)
            {
                var canvas = document.getElementById(c);
                var context = canvas.getContext("2d");

                var houseColor = "#C04000";
                var windowColor = "#F0F8FF";
                var doorColor = "#808080";

                // draw house
                context.beginPath();
                context.moveTo(2*(h/10)+x,8*(h/10)+y);
                context.lineTo(2*(h/10)+x,3*(h/10)+y);
                context.lineTo(0*(h/10)+x,3*(h/10)+y);
                context.lineTo(2*(h/10)+x,1*(h/10)+y);
                context.lineTo(6*(h/10)+x,1*(h/10)+y);
                context.lineTo(6*(h/10)+x,0*(h/10)+y);
                context.lineTo(7*(h/10)+x,0*(h/10)+y);
                context.lineTo(7*(h/10)+x,1*(h/10)+y);
                context.lineTo(8*(h/10)+x,1*(h/10)+y);
                context.lineTo(10*(h/10)+x,3*(h/10)+y);
                context.lineTo(8*(h/10)+x,3*(h/10)+y);
                context.lineTo(8*(h/10)+x,8*(h/10)+y);
                context.fillStyle = houseColor;
                context.fill();

                // draw left window
                context.beginPath();
                context.moveTo(3*(h/10)+x,3*(h/10)+y);
                context.lineTo(4*(h/10)+x,3*(h/10)+y);
                context.lineTo(4*(h/10)+x,4*(h/10)+y);
                context.lineTo(3*(h/10)+x,4*(h/10)+y);
                context.fillStyle = windowColor;
                context.fill();

                // draw right window
                context.beginPath();
                context.moveTo(6*(h/10)+x,3*(h/10)+y);
                context.lineTo(7*(h/10)+x,3*(h/10)+y);
                context.lineTo(7*(h/10)+x,4*(h/10)+y);
                context.lineTo(6*(h/10)+x,4*(h/10)+y);
                context.fillStyle = windowColor;
                context.fill();

                // draw door
                context.beginPath();
                context.moveTo(5*(h/10)+x,6*(h/10)+y);
                context.lineTo(6*(h/10)+x,6*(h/10)+y);
                context.lineTo(6*(h/10)+x,8*(h/10)+y);
                context.lineTo(5*(h/10)+x,8*(h/10)+y);
                context.fillStyle = doorColor;
                context.fill();

            }

            window.onload = function(){
                var canvas = document.getElementById("myCanvas");
                var context = canvas.getContext("2d");

                // data
                var month = "May";
                var year = "2012";

                // fake kpi
                var kpiActive = "1467";
                var kpiInactive = "1944";
                var kpiServiceLaborOpportunity = "237341";
                var kpiServicePartsOpportunity = "175632.34";
                var kpiSingleVisitCustomer = "554";


// BACKGROUND SECTION

                // fill background
                context.beginPath();
                context.rect(0, 0, canvas.width, canvas.height);
                context.fillStyle = "#2A2A2A";
                context.fill();

                // draw sections
                DrawSection("myCanvas", 0, 311, canvas.width / 2, canvas.height, [120, "#0067A5"]);
                DrawSection("myCanvas", canvas.width / 2, 311, canvas.width / 2, canvas.height, [120, "0073CF"]);
                DrawSection("myCanvas", 0, 730, canvas.width, canvas.height, [canvas.width / 2, "#8ED6FF"]);
                DrawSection("myCanvas", canvas.width / 2, 830, canvas.width, canvas.height, [canvas.width / 2, "#0047AB"]);
                DrawSection("myCanvas", 0, 930, canvas.width, canvas.height, [canvas.width / 2, "#002366"]);


// GRAPHICS SECTION

                // draw sun
                DrawSun("myCanvas", 245, 370, 50);

                // draw cloud
                DrawCloud("myCanvas", 385, 140, 180, 100)

                // draw houses
                DrawHouse("myCanvas", 70, 200, 99);
                DrawHouse("myCanvas", 452, 200, 99);


// TEXT SECTION

                // draw top text
                context.font = "40pt Calibri";
                context.fillStyle = "#eeeeee";
                context.fillText("In " + month + " Of " + year, 200, 50);

                // draw active / inactive text
                context.fillStyle = "#ffffff";

                context.font = "15pt Calibri";
                context.fillText("Active", 203, 250);
                context.fillText("Customers", 170, 265);
                context.font = "30pt Calibri";
                context.fillText(kpiActive, 255, 265);

                context.font = "15pt Calibri";
                context.fillText("Inactive", 571, 250);
                context.fillText("Customers", 550, 265);
                context.font = "30pt Calibri";
                context.fillText(kpiInactive, 635, 265);

                context.font = "35pt Calibri";
                //context.fillStyle = "#8E00FF";
                context.fillText(((Math.round((kpiSingleVisitCustomer/kpiActive) * 1000)) / 10) + "%", 100, 550);

                context.font = "15pt Calibri";
                context.fillText("are single visit", 100, 570);
                context.font = "22pt Calibri";
                context.fillText("customers", 100, 592);

                //context.fillStyle = "#8ED600";

                context.font = "36pt Calibri";
                context.fillText("Missing Monies", 420, 520);
                context.font = "24pt Calibri";
                context.fillText("Labor", 420, 574);
                context.font = "12pt Calibri";
                context.fillText("Opportunity", 420, 586);
                context.font = "36pt Calibri";
                context.fillText("$" + kpiServiceLaborOpportunity, 500, 586);

                context.font = "24pt Calibri";
                context.fillText("Parts", 420, 644);
                context.font = "12pt Calibri";
                context.fillText("Opportunity", 420, 656);
                context.font = "36pt Calibri";
                context.fillText("$" + kpiServicePartsOpportunity, 500, 656);
            };
 
        </script>
    </head>
    <body>
        <canvas id="myCanvas" width="1536" height="1500">
        </canvas>
    </body>
</html>
